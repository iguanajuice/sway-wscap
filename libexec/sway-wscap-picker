#!/bin/sh

pw-link -i | grep -q :input_1 || rm /dev/shm/sway-wscap-pwlinks # clear shm if no video inputs are present

export OUTPUT=`slurp -f %o -or`
echo $OUTPUT
[ -z $OUTPUT ] && exit 1

swaymsg focus output $OUTPUT # fixes weird bug, dont ask
export CHOICE=$(
	swaynag -t warning -m 'Choose what to capture:' \
			-s 'Capture entire output' \
			-z 'Just this workspace' 'echo 1' \
				&>/dev/null
)

[ -n $CHOICE ] && `dirname $0`/sway-wscap $OUTPUT $CHOICE &
